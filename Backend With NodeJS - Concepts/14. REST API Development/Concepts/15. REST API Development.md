# Topic 14 REST API Development

---

### **Concept**

**What is a REST API?**

* **REST (Representational State Transfer)** is an **architectural style** for designing **scalable and stateless web services**.
* It uses **HTTP methods (GET, POST, PUT, DELETE)** to perform CRUD operations (Create, Read, Update, Delete) on **resources**.

**Example:**
A REST API for users:

| HTTP Method | Endpoint         | Description       |
| ----------- | ---------------- | ----------------- |
| GET         | `/api/users`     | Get all users     |
| POST        | `/api/users`     | Create a new user |
| PUT         | `/api/users/:id` | Update a user     |
| DELETE      | `/api/users/:id` | Delete a user     |

---

### **Why REST API?**

| Feature                  | Explanation                                      |
| ------------------------ | ------------------------------------------------ |
| **Stateless**            | Each request contains all necessary information. |
| **Platform-independent** | Can be consumed by frontend, mobile apps, etc.   |
| **Uniform Interface**    | Standardized HTTP methods and responses.         |
| **Easy Testing**         | Works with tools like Postman and curl.          |

---

### **How REST API Works**

1. **Client** sends HTTP request to the **Server**.
2. **Server** processes it and interacts with a database or logic layer.
3. **Response** is sent back as **JSON**.
4. Communication is **stateless** — every request is independent.

---

### **Folder Setup**

```
rest-api-demo/
│
├── app.js
└── data/
    └── users.json
```

---

### **Step 1: Install Express**

```bash
npm init -y
npm install express
```

---

### **Code Example 1: Basic REST API**

**File:** `app.js`

```js
// ===========================
// Example: Basic REST API
// ===========================

const express = require('express');
const app = express();

// Middleware to parse JSON body
app.use(express.json());

let users = [
  { id: 1, name: 'Tanish', email: 'tanish@example.com' },
  { id: 2, name: 'Ravi', email: 'ravi@example.com' }
];

// GET all users
app.get('/api/users', (req, res) => {
  res.status(200).json(users);
});

// GET user by ID
app.get('/api/users/:id', (req, res) => {
  const user = users.find(u => u.id === parseInt(req.params.id));
  if (!user) return res.status(404).json({ message: 'User not found' });
  res.json(user);
});

// POST create user
app.post('/api/users', (req, res) => {
  const newUser = { id: users.length + 1, ...req.body };
  users.push(newUser);
  res.status(201).json(newUser);
});

// PUT update user
app.put('/api/users/:id', (req, res) => {
  const user = users.find(u => u.id === parseInt(req.params.id));
  if (!user) return res.status(404).json({ message: 'User not found' });

  user.name = req.body.name;
  user.email = req.body.email;
  res.json({ message: 'User updated', user });
});

// DELETE user
app.delete('/api/users/:id', (req, res) => {
  users = users.filter(u => u.id !== parseInt(req.params.id));
  res.json({ message: 'User deleted' });
});

// Start server
app.listen(3000, () => console.log('Server running on http://localhost:3000'));
```

---

### **Test the API (Using Postman or curl)**

| Method | Endpoint       | Example Payload                                     | Response                     |
| ------ | -------------- | --------------------------------------------------- | ---------------------------- |
| GET    | `/api/users`   | -                                                   | `[ {id:1,...}, {id:2,...} ]` |
| GET    | `/api/users/1` | -                                                   | `{id:1, name:'Tanish'}`      |
| POST   | `/api/users`   | `{ "name": "Aryan", "email": "aryan@example.com" }` | `User created`               |
| PUT    | `/api/users/1` | `{ "name": "Tanish K", "email": "tk@example.com" }` | `User updated`               |
| DELETE | `/api/users/2` | -                                                   | `User deleted`               |

---

### **Code Example 2: REST API with Validation**

**File:** `app.js` (extended)

```js
// ===========================
// Example: API with Validation
// ===========================

const express = require('express');
const app = express();
app.use(express.json());

let products = [
  { id: 1, name: 'Keyboard', price: 1200 },
  { id: 2, name: 'Mouse', price: 800 },
];

// POST with validation
app.post('/api/products', (req, res) => {
  const { name, price } = req.body;
  if (!name || !price)
    return res.status(400).json({ message: 'Name and price are required' });

  const newProduct = { id: products.length + 1, name, price };
  products.push(newProduct);
  res.status(201).json(newProduct);
});

app.listen(4000, () => console.log('Validation API running on port 4000'));
```

---

### **Code Example 3: Express Router Structure**

**Folder:**

```
rest-router/
│
├── app.js
└── routes/
    └── userRoutes.js
```

**File:** `routes/userRoutes.js`

```js
const express = require('express');
const router = express.Router();

let users = [{ id: 1, name: 'Tanish' }];

// All routes related to users
router.get('/', (req, res) => res.json(users));
router.post('/', (req, res) => {
  const newUser = { id: users.length + 1, ...req.body };
  users.push(newUser);
  res.status(201).json(newUser);
});

module.exports = router;
```

**File:** `app.js`

```js
const express = require('express');
const userRoutes = require('./routes/userRoutes');
const app = express();

app.use(express.json());
app.use('/api/users', userRoutes);

app.listen(5000, () => console.log('Server running on http://localhost:5000'));
```

**Routes:**

* GET `/api/users`
* POST `/api/users`

---

### **Mini Project: Simple Notes API**

**Goal:** Create a REST API to manage notes.

**Folder:**

```
notes-api/
│
├── app.js
└── data/
    └── notes.json
```

**File:** `app.js`

```js
// ===========================
// Mini Project: Notes REST API
// ===========================

const express = require('express');
const fs = require('fs');
const path = require('path');

const app = express();
app.use(express.json());

const notesFile = path.join(__dirname, 'data', 'notes.json');

// GET all notes
app.get('/api/notes', (req, res) => {
  const notes = JSON.parse(fs.readFileSync(notesFile, 'utf8'));
  res.json(notes);
});

// POST new note
app.post('/api/notes', (req, res) => {
  const notes = JSON.parse(fs.readFileSync(notesFile, 'utf8'));
  const newNote = { id: notes.length + 1, ...req.body };
  notes.push(newNote);
  fs.writeFileSync(notesFile, JSON.stringify(notes, null, 2));
  res.status(201).json(newNote);
});

// DELETE note
app.delete('/api/notes/:id', (req, res) => {
  let notes = JSON.parse(fs.readFileSync(notesFile, 'utf8'));
  notes = notes.filter(n => n.id !== parseInt(req.params.id));
  fs.writeFileSync(notesFile, JSON.stringify(notes, null, 2));
  res.json({ message: 'Note deleted' });
});

// Start server
app.listen(6000, () => console.log('Notes API running on port 6000'));
```

**File:** `data/notes.json`

```json
[]
```

**Test Endpoints:**

* `GET /api/notes`
* `POST /api/notes`
* `DELETE /api/notes/:id`

---

### **Dependencies**

| Package      | Purpose                         |
| ------------ | ------------------------------- |
| **express**  | Web framework for REST API      |
| **fs, path** | File handling for mock database |

---

### **Notes**

* REST APIs follow **stateless architecture**.
* Use **HTTP status codes** properly:

  * `200 OK` → success
  * `201 Created` → new resource created
  * `400 Bad Request` → validation error
  * `404 Not Found` → resource missing
* Keep logic clean with **Routers & Controllers**.
* Real-world apps connect REST APIs to **databases (MongoDB, SQL)**.

---